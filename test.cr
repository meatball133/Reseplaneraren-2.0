require "http/client"
require "json"

KEY = "eyJ4NXQiOiJaV05sTURNNE56SmpZelZrT1dFNU16RTFNalF5TTJaaE5XSm1ORE0zWkRVMk9HRXdOVGxqWVRjNE1tWTNPRGcwWW1JeFlqSTFPVGMzTjJWallqZzRNdyIsImtpZCI6IlpXTmxNRE00TnpKall6VmtPV0U1TXpFMU1qUXlNMlpoTldKbU5ETTNaRFUyT0dFd05UbGpZVGM0TW1ZM09EZzBZbUl4WWpJMU9UYzNOMlZqWWpnNE13X1JTMjU2IiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ0NGRTOVNCblQwenBZVEd4NThiUk1xTHY2eEVhIiwiYXV0IjoiQVBQTElDQVRJT04iLCJiaW5kaW5nX3R5cGUiOiJyZXF1ZXN0IiwiaXNzIjoiaHR0cHM6XC9cL2V4dC1hcGkudmFzdHRyYWZpay5zZVwvdG9rZW4iLCJ0aWVySW5mbyI6eyJVbmxpbWl0ZWQiOnsidGllclF1b3RhVHlwZSI6InJlcXVlc3RDb3VudCIsImdyYXBoUUxNYXhDb21wbGV4aXR5IjowLCJncmFwaFFMTWF4RGVwdGgiOjAsInN0b3BPblF1b3RhUmVhY2giOnRydWUsInNwaWtlQXJyZXN0TGltaXQiOjAsInNwaWtlQXJyZXN0VW5pdCI6bnVsbH19LCJrZXl0eXBlIjoiUFJPRFVDVElPTiIsInN1YnNjcmliZWRBUElzIjpbeyJzdWJzY3JpYmVyVGVuYW50RG9tYWluIjoiY2FyYm9uLnN1cGVyIiwibmFtZSI6ImFwaTAwMTMtcHIiLCJjb250ZXh0IjoiXC9wclwvdjQiLCJwdWJsaXNoZXIiOiJhZG1pbiIsInZlcnNpb24iOiJ2NCIsInN1YnNjcmlwdGlvblRpZXIiOiJVbmxpbWl0ZWQifV0sImF1ZCI6Imh0dHBzOlwvXC9leHQtYXBpLnZhc3R0cmFmaWsuc2UiLCJuYmYiOjE3MDMyNTk0NTQsImFwcGxpY2F0aW9uIjp7Im93bmVyIjoidDRkUzlTQm5UMHpwWVRHeDU4YlJNcUx2NnhFYSIsInRpZXJRdW90YVR5cGUiOm51bGwsInRpZXIiOiJVbmxpbWl0ZWQiLCJuYW1lIjoiUmVzZXBsYW5lcmFyZW5fMiIsImlkIjoxOTI5LCJ1dWlkIjoiYzRiYzljZmQtZmI5ZS00NGY0LTlmMjItNDUxNDc3NmM0ZDI4In0sImF6cCI6InQ0ZFM5U0JuVDB6cFlUR3g1OGJSTXFMdjZ4RWEiLCJzY29wZSI6ImFwaW06c3Vic2NyaWJlIiwiZXhwIjoxNzAzMzQ1ODU0LCJpYXQiOjE3MDMyNTk0NTQsImJpbmRpbmdfcmVmIjoiY2ExNzU2YWRjYjQ3MzM0NDE3NzM3YjdmYjFhMjM5MGIiLCJqdGkiOiI0MzI2NzZlZi0zOGZmLTQ2OGYtODkyOS0yNDMzYjAzMDNlZDQifQ.LoPGMKEnugQGOpvbt9J4tjyxbA3hBHhnYdpJQwq-C_5c_Uy23nWUh5qZzvrQDcIjWLcIRORl4kndQg54TtNS6GgAFPTiTRX-VBPe7hSlPFrwMe6U6y9YOWgu1ZjJnLg197zSQaJW0pdGVzInpRfma6ihu4muFVYCkzbj0NzeBljSEpXBG-LYL7zBv_d-lvk-QN1LcG2rOu15PKKMsx53IcKbTspIptHRAqdJ0E8iNTfFY91Nk_Yw4wHPsDWaKN5mgEBcw_Ix4unCTLk_OBdSAOITscqJ7E5SyVqPiJGK6XcmoMraI0yMaecdwAf4JhSJdqoHAk4nXHg_Kog78viQJA"

params = URI::Params.encode({"originGid" => "9021014001760000", "destinationGid" => "9021014003980000", "Authorization" => KEY})
p URI.new("https", "ext-api.vasttrafik.se", path: "/pr/v4/journeys", query: params)
response = HTTP::Client.get(URI.new("https", "ext-api.vasttrafik.se", path: "/pr/v4/journeys", query: params), HTTP::Headers{"Authorization" => "Bearer #{KEY}", "accept" => "application/json"})

File.write("test.json", response.body)

